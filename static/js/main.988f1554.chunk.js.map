{"version":3,"sources":["utils/index.js","utils/constant.js","components/Gantt/Gantt.js","components/Gantt/index.js","components/Toolbar/Toolbar.js","components/Toolbar/index.js","components/MessageArea/MessageArea.js","components/MessageArea/index.js","App.js","registerServiceWorker.js","index.js"],"names":["getAllLayerAmount","uid","children","childrenAmount","findAllChildren","gantt","getChildren","forEach","item","userInfo","getTask","push","teamMember","length","teamAmount","reduce","accumulator","currentValue","Number","getFirstLayerAmount","childrenID","total","childID","amount","getSelfLevel","data","directMember","directMemberAmount","isLevelIB","getSelfProgress","start_date","entrustInDate","Date","getTime","progress","Math","floor","holderEditor","type","map_to","amountEditor","startDateEditor","min","max","dateToStr","date","date_to_str","config","task_date","INIT_DATA","id","holder","duration","parent","level","end_date","$open","links","source","target","ZOOM_CONFIG","levels","name","scale_height","min_column_width","scales","unit","step","format","endDate","add","height","Gantt","props","dataProcessor","initZoom","ext","zoom","init","CONSTANT","value","setLevel","onDataUpdated","this","createDataProcessor","action","Promise","resolve","reject","nextProps","addMarker","css","text","title","utils","keyboard_navigation_cells","multiselect","quickinfo_buttons","reorder_grid_columns","order_branch","keep_grid_width","xml_date","columns","label","align","max_width","resize","template","getWBSCode","min_width","tree","editor","task","lightbox","sections","default_value","allow_root","root_label","start","end","ev","locale","labels","attachEvent","isNew","isNaN","message","link","templates","task_class","0","1","2","3","match","quick_info_title","quick_info_content","scale_cell_class","getDay","timeline_cell_class","task_text","rightside_text","progress_text","link_class","grid_folder","grid_file","drag_link","from","from_start","to","to_start","link_description","types","start_to_start","finish_to_start","tasks","ganttContainer","initGanttDataProcessor","parse","destructor","setZoom","ref","input","style","width","Component","Toolbar","handleImportData","useState","isFullGrid","setIsFullGrid","useEffect","importFromJSON","event","files","FILE_READER","FileReader","addEventListener","NEW_DATA","JSON","result","validatedNewData","unsafeData","map","localStorage","setItem","stringify","err","readAsText","className","onClick","getGridColumn","hide","grid_width","render","undo","redo","zoomIn","zoomOut","fullscreen","expand","window","importBox","modalbox","buttons","callback","location","reload","serialize","fileDownloader","toISOString","substring","split","join","exportAndDownload","MessageArea","renderMessageArea","messages","key","random","defaultProps","App","state","isReady","isUpdating","currentZoom","logDataUpdate","setState","addMessage","currentData","currentLinks","newItem","updateImportData","LOCAL_DATA","getItem","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","error","ReactDOM","document","getElementById","URL","process","origin","fetch","response","status","headers","get","indexOf","ready","unregister","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.988f1554.chunk.js","sourcesContent":["import { gantt } from \"dhtmlx-gantt\";\n\nconst isLevelIB = (data) => {\n  const { amount, directMember, directMemberAmount, teamAmount } = data;\n  return (\n    Number(amount) >= 1500 &&\n    Number(directMember) >= 4 &&\n    Number(directMemberAmount) >= 9000 &&\n    Number(teamAmount) >= 15000\n  );\n};\n\nexport const levelConverter = (level) => {\n  switch (level) {\n    case \"ib\":\n      return \"IB 經理人\";\n    case \"mib\":\n      return \"MIB 經理人\";\n    case \"pib\":\n      return \"PIB 經理人\";\n    default:\n      return \"投資人\";\n  }\n};\n\nexport const getAllLayerAmount = (uid) => {\n  let children = [];\n  let childrenAmount = [];\n\n  const findAllChildren = (uid) => {\n    gantt.getChildren(uid).forEach((item) => {\n      const userInfo = gantt.getTask(item);\n      children.push(userInfo[\"holder\"]);\n      childrenAmount.push(userInfo[\"amount\"]);\n      findAllChildren(item);\n    });\n  };\n\n  findAllChildren(uid);\n\n  return {\n    teamMember: children.length,\n    teamAmount: childrenAmount.reduce(\n      (accumulator, currentValue) => accumulator + Number(currentValue),\n      0\n    ),\n  };\n};\n\nexport const getFirstLayerAmount = (uid) => {\n  const childrenID = gantt.getChildren(uid);\n  let total = 0;\n  childrenID.forEach((childID) => {\n    const userInfo = gantt.getTask(childID);\n    total += Number(userInfo.amount ?? 0);\n  });\n\n  return total;\n};\n\nexport const getSelfLevel = (uid) => {\n  /*\n    TODO implement this function\n    ['trader', 'ib', 'mib', 'pib']\n  */\n  const selfData = gantt.getTask(uid);\n  if (isLevelIB(selfData)) {\n    return \"ib\";\n  }\n  return \"trader\";\n};\n\nexport const sterilizateData = (unsafeData) => {\n  const sterilizatedData = {\n    data: unsafeData?.data.map((item) => ({\n      id: item?.id,\n      holder: item?.holder,\n      amount: item?.amount,\n      directMember: item?.directMember,\n      directMemberAmount: item?.directMemberAmount,\n      teamMember: item?.teamMember,\n      teamAmount: item?.teamAmount,\n      level: item?.level,\n      start_date: item?.start_date,\n      duration: item?.duration,\n      end_date: item?.end_date,\n      parent: item?.parent,\n      progress: item?.progress,\n      $open: true,\n    })),\n    links: unsafeData?.links.map((item) => ({\n      id: item.id,\n      source: item.source,\n      target: item.target,\n      type: item.type,\n    })),\n  };\n\n  return sterilizatedData;\n};\n\nexport const getSelfProgress = (start_date) => {\n  const entrustInDate =\n    (new Date().getTime() - new Date(start_date).getTime()) /\n    (1000 * 3600 * 24);\n  const progress = Math.floor((entrustInDate / 35) * 100) / 100;\n\n  if (progress <= 0) {\n    return 0;\n  } else if (progress >= 100) {\n    return 100;\n  }\n  return Math.floor((entrustInDate / 35) * 100) / 100;\n};\n\nexport const holderEditor = { type: \"text\", map_to: \"holder\" };\nexport const amountEditor = { type: \"text\", map_to: \"amount\" };\nexport const durationEditor = {\n  type: \"number\",\n  map_to: \"duration\",\n  min: 0,\n  max: 50,\n};\nexport const startDateEditor = {\n  type: \"date\",\n  map_to: \"start_date\",\n  min: new Date(2018, 0, 1),\n  max: new Date(),\n};\n\nexport const dateToStr = gantt.date.date_to_str(gantt.config.task_date);\n","import { gantt } from \"dhtmlx-gantt\";\n\nexport const INIT_DATA = {\n  data: [\n    {\n      id: 1,\n      holder: \"自己\",\n      start_date: \"2020-07-16 00:00\",\n      amount: 1500,\n      duration: 35,\n      directMember: 5,\n      directMemberAmount: 23600,\n      teamMember: 6,\n      teamAmount: 23600,\n      progress: 0.51,\n      parent: 0,\n      level: \"ib\",\n      end_date: \"2020-08-20 00:00\",\n      $open: true,\n    },\n    {\n      id: 2,\n      holder: \"投資人 #1\",\n      start_date: \"2020-07-20 00:00\",\n      parent: 1,\n      amount: 1500,\n      duration: 35,\n      directMember: 1,\n      directMemberAmount: 0,\n      teamMember: 1,\n      teamAmount: 0,\n      progress: 0.39,\n      level: \"trader\",\n      end_date: \"2020-08-24 00:00\",\n      $open: true,\n    },\n    {\n      duration: 35,\n      id: 1596379445693,\n      start_date: \"2020-07-24 00:00\",\n      parent: \"2\",\n      progress: 0.28,\n      holder: \"投資人 #6\",\n      amount: \"0\",\n      directMember: 0,\n      directMemberAmount: 0,\n      teamMember: 0,\n      teamAmount: 0,\n      level: \"trader\",\n      end_date: \"2020-08-28 00:00\",\n      $open: true,\n    },\n    {\n      duration: 35,\n      id: 1596379445681,\n      start_date: \"2020-07-16 00:00\",\n      parent: \"1\",\n      progress: 0.51,\n      holder: \"投資人 #2\",\n      amount: \"1500\",\n      directMember: 0,\n      directMemberAmount: 0,\n      teamMember: 0,\n      teamAmount: 0,\n      level: \"trader\",\n      end_date: \"2020-08-20 00:00\",\n      $open: true,\n    },\n    {\n      duration: 35,\n      id: 1596379445695,\n      start_date: \"2020-07-16 00:00\",\n      parent: \"1\",\n      progress: 0.51,\n      holder: \"投資人 #3\",\n      amount: \"9000\",\n      directMember: 0,\n      directMemberAmount: 0,\n      teamMember: 0,\n      teamAmount: 0,\n      level: \"trader\",\n      end_date: \"2020-08-20 00:00\",\n      $open: true,\n    },\n    {\n      duration: 35,\n      id: 1596379445697,\n      start_date: \"2020-07-18 00:00\",\n      parent: \"1\",\n      progress: 0.45,\n      holder: \"投資人 #4\",\n      amount: \"1600\",\n      directMember: 0,\n      directMemberAmount: 0,\n      teamMember: 0,\n      teamAmount: 0,\n      level: \"trader\",\n      end_date: \"2020-08-22 00:00\",\n      $open: true,\n    },\n    {\n      duration: 35,\n      id: 1596379445699,\n      start_date: \"2020-07-12 00:00\",\n      parent: \"1\",\n      progress: 0.62,\n      holder: \"投資人 #5\",\n      amount: \"10000\",\n      directMember: 0,\n      directMemberAmount: 0,\n      teamMember: 0,\n      teamAmount: 0,\n      level: \"trader\",\n      end_date: \"2020-08-16 00:00\",\n      $open: true,\n    },\n  ],\n  links: [\n    {\n      id: 1,\n      source: 1,\n      target: 2,\n      type: \"1\",\n    },\n    {\n      source: \"1\",\n      target: \"1596379445681\",\n      type: \"1\",\n      id: 1596379445692,\n    },\n    {\n      source: \"2\",\n      target: \"1596379445693\",\n      type: \"1\",\n      id: 1596379445694,\n    },\n    {\n      source: \"1\",\n      target: \"1596379445695\",\n      type: \"1\",\n      id: 1596379445696,\n    },\n    {\n      source: \"1\",\n      target: \"1596379445697\",\n      type: \"1\",\n      id: 1596379445698,\n    },\n    {\n      source: \"1\",\n      target: \"1596379445699\",\n      type: \"1\",\n      id: 1596379445700,\n    },\n  ],\n};\n\nexport const ZOOM_CONFIG = {\n  levels: [\n    {\n      name: \"日\",\n      scale_height: 27,\n      min_column_width: 80,\n      scales: [{ unit: \"day\", step: 1, format: \"%d %M\" }],\n    },\n    {\n      name: \"週\",\n      scale_height: 50,\n      min_column_width: 50,\n      scales: [\n        {\n          unit: \"week\",\n          step: 1,\n          format: function (date) {\n            var dateToStr = gantt.date.date_to_str(\"%d %M\");\n            var endDate = gantt.date.add(date, -6, \"day\");\n            var weekNum = gantt.date.date_to_str(\"%W\")(date);\n            return (\n              \"#\" +\n              weekNum +\n              \", \" +\n              dateToStr(date) +\n              \" - \" +\n              dateToStr(endDate)\n            );\n          },\n        },\n        { unit: \"day\", step: 1, format: \"%j %D\" },\n      ],\n    },\n    {\n      name: \"月\",\n      scale_height: 50,\n      min_column_width: 120,\n      scales: [\n        { unit: \"month\", format: \"%F, %Y\" },\n        { unit: \"week\", format: \"Week #%W\" },\n      ],\n    },\n    {\n      name: \"季\",\n      height: 50,\n      min_column_width: 90,\n      scales: [\n        { unit: \"month\", step: 1, format: \"%M\" },\n        {\n          unit: \"quarter\",\n          step: 1,\n          format: function (date) {\n            var dateToStr = gantt.date.date_to_str(\"%M\");\n            var endDate = gantt.date.add(\n              gantt.date.add(date, 3, \"month\"),\n              -1,\n              \"day\"\n            );\n            return dateToStr(date) + \" - \" + dateToStr(endDate);\n          },\n        },\n      ],\n    },\n    {\n      name: \"年\",\n      scale_height: 50,\n      min_column_width: 30,\n      scales: [{ unit: \"year\", step: 1, format: \"%Y\" }],\n    },\n  ],\n};\n","import React, { Component } from \"react\";\nimport { gantt } from \"dhtmlx-gantt\";\nimport \"dhtmlx-gantt/codebase/ext/dhtmlxgantt_marker.js\";\nimport \"dhtmlx-gantt/codebase/ext/dhtmlxgantt_fullscreen.js\";\nimport \"dhtmlx-gantt/codebase/ext/dhtmlxgantt_marker.js\";\nimport \"dhtmlx-gantt/codebase/ext/dhtmlxgantt_quick_info.js\";\nimport \"dhtmlx-gantt/codebase/ext/dhtmlxgantt_undo.js\";\nimport \"dhtmlx-gantt/codebase/ext/dhtmlxgantt_keyboard_navigation.js\";\nimport \"dhtmlx-gantt/codebase/ext/dhtmlxgantt_multiselect.js\";\nimport \"dhtmlx-gantt/codebase/locale/locale_cn.js\";\nimport \"./dhtmlxgantt_material.css\";\n\nimport * as utils from \"../../utils\";\nimport * as CONSTANT from \"../../utils/constant\";\n\nexport default class Gantt extends Component {\n  constructor(props) {\n    super(props);\n    this.initZoom();\n  }\n\n  // instance of gantt.dataProcessor\n  dataProcessor = null;\n\n  initZoom() {\n    gantt.ext.zoom.init(CONSTANT.ZOOM_CONFIG);\n  }\n\n  setZoom(value) {\n    gantt.ext.zoom.setLevel(value);\n  }\n\n  initGanttDataProcessor() {\n    /**\n     * type: \"task\"|\"link\"\n     * action: \"create\"|\"update\"|\"delete\"\n     * item: data object object\n     */\n    const onDataUpdated = this.props.onDataUpdated;\n    this.dataProcessor = gantt.createDataProcessor((type, action, item, id) => {\n      return new Promise((resolve, reject) => {\n        if (onDataUpdated) {\n          onDataUpdated(type, action, item, id);\n        }\n\n        // if onDataUpdated changes returns a permanent id of the created item, you can return it from here so dhtmlxGantt could apply it\n        // resolve({id: databaseId});\n        return resolve();\n      });\n    });\n  }\n\n  shouldComponentUpdate(nextProps) {\n    return this.props.zoom !== nextProps.zoom;\n  }\n\n  componentDidMount() {\n    gantt.addMarker({\n      start_date: new Date(),\n      css: \"today\",\n      text: \"今天\",\n      title: utils.dateToStr(new Date()),\n    });\n\n    gantt.config.keyboard_navigation_cells = true;\n    gantt.config.multiselect = true;\n    gantt.config.quickinfo_buttons = [\"icon_edit\", \"icon_delete\"];\n    gantt.config.reorder_grid_columns = true;\n    gantt.config.order_branch = true;\n    gantt.config.keep_grid_width = true;\n    gantt.config.xml_date = \"%Y-%m-%d %H:%i\";\n    gantt.config.columns = [\n      {\n        name: \"wbs\",\n        label: \"編號\",\n        align: \"center\",\n        max_width: 64,\n        resize: true,\n        template: gantt.getWBSCode,\n      },\n      {\n        name: \"holder\",\n        label: \"投資人\",\n        min_width: 128,\n        max_width: 228,\n        tree: true,\n        resize: true,\n        editor: utils.holderEditor,\n      },\n      {\n        name: \"amount\",\n        label: \"投資額\",\n        align: \"center\",\n        max_width: 80,\n        resize: true,\n        editor: utils.amountEditor,\n      },\n      {\n        name: \"start_date\",\n        label: \"初始託管日\",\n        align: \"center\",\n        min_width: 80,\n        max_width: 96,\n        resize: true,\n        editor: utils.startDateEditor,\n      },\n      {\n        name: \"add_buttons\",\n        label: `<div class=\"gantt_grid_head_cell gantt_grid_head_add\" onclick=\"gantt.createTask({duration: 35})\"><i class=\"fa fa-plus\"></i></div>`,\n        align: \"center\",\n        max_width: 40,\n        template: (task) =>\n          `<i class=\"fa gantt_button_grid gantt_grid_add fa-plus\" onclick=\"gantt.createTask({duration: 35}, ${task.id});\"></i>`,\n      },\n    ];\n    gantt.config.lightbox.sections = [\n      {\n        name: \"holder\",\n        height: 30,\n        map_to: \"holder\",\n        type: \"textarea\",\n      },\n      {\n        name: \"amount\",\n        height: 30,\n        default_value: \"0\",\n        map_to: \"amount\",\n        type: \"textarea\",\n      },\n      {\n        name: \"parent\",\n        type: \"parent\",\n        allow_root: \"true\",\n        root_label: \"無推薦經紀人\",\n        template: (start, end, ev) =>\n          ev.id === 0 ? \"無推薦經紀人\" : ev.holder,\n      },\n      { name: \"time\", map_to: \"auto\", type: \"duration\" },\n      // {\n      //   name: \"profit\",\n      //   map_to: { start_date: \"profit_date\" },\n      //   type: \"duration_optional\",\n      //   button: true,\n      //   single_date: true,\n      // },\n    ];\n    gantt.locale.labels[\"section_holder\"] = \"投資人\";\n    gantt.locale.labels[\"section_amount\"] = \"投資額\";\n    gantt.locale.labels[\"section_parent\"] = \"推薦經紀人\";\n    gantt.locale.labels[\"section_time\"] = \"託管時間\";\n    gantt.locale.labels[\"icon_delete\"] = \"刪除紀錄\";\n    gantt.locale.labels[\"icon_edit\"] = \"編輯紀錄\";\n    gantt.locale.labels[\"confirm_deleting\"] = \"是否刪除紀錄？\";\n    gantt.locale.labels[\"link\"] = \"連結\";\n    gantt.locale.labels[\"confirm_link_deleting\"] = \"將被刪除\";\n    gantt.locale.labels[\"message_cancel\"] = \"關閉\";\n    gantt.locale.labels[\"icon_save\"] = \"儲資金紀錄\";\n    gantt.locale.labels[\"icon_cancel\"] = \"取消\";\n    // gantt.locale.labels[\"section_profit\"] = \"最近一次獲利紀錄\";\n    // gantt.locale.labels[\"profit_enable_button\"] = \"加入獲利紀錄\";\n    // gantt.locale.labels[\"profit_disable_button\"] = \"移除獲利紀錄\";\n\n    gantt.attachEvent(\"onLightboxSave\", function (id, item, isNew) {\n      if (!item.holder) {\n        gantt.message({ type: \"error\", text: \"請輸入投資人\" });\n        return false;\n      }\n      if (!item.amount || isNaN(item.amount)) {\n        gantt.message({\n          type: \"error\",\n          text: \"請輸入正確的投資額\",\n        });\n        return false;\n      }\n\n      if (isNew) {\n        item.progress = 0.5;\n        item.directMember = 0;\n        item.directMemberAmount = 0;\n        item.teamMember = 0;\n        item.teamAmount = 0;\n      }\n      return true;\n    });\n    gantt.attachEvent(\"onBeforeLinkAdd\", function (id, link) {\n      if (link.type !== \"1\") {\n        gantt.message({\n          type: \"error\",\n          text: \"請從託管開始日開始連接\",\n        });\n        return false;\n      }\n    });\n\n    gantt.templates.task_class = function (start, end, task) {\n      const currentLayer = (gantt.getWBSCode(task).match(/\\./g) || []).length;\n      const LAYER_TABLE = {\n        0: \"top-layer\",\n        1: \"first-layer\",\n        2: \"second-layer\",\n        3: \"third-layer\",\n      };\n      return LAYER_TABLE[currentLayer];\n    };\n    gantt.templates.quick_info_title = (start, end, task) =>\n      `${task.holder} 綁定 ${task.amount} 美金`;\n    gantt.templates.quick_info_content = (start, end, task) =>\n      `身份： ${utils.levelConverter(task.level)} </br>\n      自身綁定： ${task.amount} </br>\n      有效直推：${task[\"directMember\"]} </br>\n      直推綁定： ${task[\"directMemberAmount\"]} </br>\n      團隊人數： ${task[\"teamMember\"]} </br>\n      團隊綁定： ${task[\"teamAmount\"]} </br>\n      `;\n    gantt.templates.scale_cell_class = (date) => {\n      if (date.getDay() === 0 || date.getDay() === 6) {\n        return \"weekend\";\n      }\n    };\n    gantt.templates.timeline_cell_class = (task, date) => {\n      if (date.getDay() === 0 || date.getDay() === 6) {\n        return \"weekend\";\n      }\n    };\n    gantt.templates.task_text = (start, end, task) =>\n      task.holder && task.amount\n        ? `<b>${task.holder}</b> &nbsp; 綁定 &nbsp; <b>${task.amount}</b> &nbsp; 美金`\n        : \"\";\n    gantt.templates.rightside_text = (start, end, task) => {\n      const entrustInDate =\n        (new Date().getTime() - new Date(start).getTime()) / (1000 * 3600 * 24);\n      if (entrustInDate > 0) {\n        return \"<b>託管 </b>\" + Math.floor(entrustInDate) + \"天\";\n      } else {\n        return \"<b>尚未開始託管</b>\";\n      }\n    };\n    gantt.templates.progress_text = (start, end, task) =>\n      \"<span class='progress_text'>\" +\n      gantt.getChildren(task.id).length +\n      \" 直推 </span>\";\n    gantt.templates.link_class = (link) => {\n      const LINK_TABLE = {\n        1: \"first-link\",\n        2: \"second-link\",\n        3: \"third-link\",\n      };\n      return LINK_TABLE[link.source] ?? \"\";\n    };\n    gantt.templates.grid_folder = (item) =>\n      `<div class='gantt_tree_icon gantt_folder_${\n        item.$open ? \"open\" : \"closed\"\n      } ${item.level}'></div>`;\n    gantt.templates.grid_file = (item) =>\n      `<div class='gantt_tree_icon gantt_file ${item.level}'></div>`;\n    gantt.templates.drag_link = (from, from_start, to, to_start) => {\n      from = gantt.getTask(from);\n      let text = `推薦人 > <b>${from.holder}</b> ${\n        from_start ? \"\" : \"結束\"\n      }<br/>`;\n      if (to) {\n        to = gantt.getTask(to);\n        text += `投資人 > <b>${to.holder}</b> ${to_start ? \"\" : \"結束\"} <br/>`;\n      }\n      return text;\n    };\n    gantt.templates.link_description = function (link) {\n      let from = gantt.getTask(link.source),\n        to = gantt.getTask(link.target),\n        types = gantt.config.links;\n\n      let from_start = link.type === types.start_to_start;\n      let to_start =\n        link.type === types.finish_to_start ||\n        link.type === types.start_to_start;\n      let text = `推薦人 <b>${from.holder}</b> ${\n        from_start ? \"\" : \"結束\"\n      } <br/>`;\n      text += `與 投資人 <b>${to.holder}</b> ${to_start ? \"\" : \"結束\"} <br/>`;\n      return text;\n    };\n\n    // gantt.addTaskLayer({\n    //   renderer: {\n    //     render: function draw_profit(task) {\n    //       if (task.profit_date) {\n    //         var el = document.createElement(\"div\");\n    //         el.className = \"profit\";\n    //         var sizes = gantt.getTaskPosition(task, task.profit_date);\n\n    //         el.style.left = sizes.left + \"px\";\n    //         el.style.top = sizes.top + \"px\";\n\n    //         el.setAttribute(\n    //           \"title\",\n    //           gantt.templates.task_date(task.profit_date)\n    //         );\n    //         return el;\n    //       }\n    //       return false;\n    //     },\n    //     // define getRectangle in order to hook layer with the smart rendering\n    //     getRectangle: function (task, view) {\n    //       if (task.profit_date) {\n    //         return gantt.getTaskPosition(task, task.profit_date);\n    //       }\n    //       return null;\n    //     },\n    //   },\n    // });\n\n    // gantt.attachEvent(\"onTaskLoading\", function (task) {\n    //   if (task.profit_date) {\n    //     task.profit_date = gantt.date.parseDate(task.profit_date, \"xml_date\");\n    //   }\n    //   return true;\n    // });\n\n    const { tasks } = this.props;\n    gantt.init(this.ganttContainer);\n    this.initGanttDataProcessor();\n    gantt.parse(tasks);\n  }\n\n  componentWillUnmount() {\n    if (this.dataProcessor) {\n      this.dataProcessor.destructor();\n      this.dataProcessor = null;\n    }\n  }\n\n  render() {\n    const { zoom } = this.props;\n    this.setZoom(zoom);\n    return (\n      <div\n        ref={(input) => {\n          this.ganttContainer = input;\n        }}\n        style={{ width: \"100%\", height: \"100%\" }}\n      />\n    );\n  }\n}\n","import Gantt from './Gantt';\nimport './Gantt.css';\nexport default Gantt;","import React, { useState, useEffect } from \"react\";\nimport { gantt } from \"dhtmlx-gantt\";\nimport {\n  Menu,\n  ChevronRight,\n  SkipBack,\n  SkipForward,\n  Maximize,\n  ZoomIn,\n  ZoomOut,\n  Settings,\n} from \"react-feather\";\nimport fileDownloader from \"js-file-download\";\n\nimport * as CONSTANT from \"../../utils/constant\";\nimport * as utils from \"../../utils\";\n\nconst Toolbar = ({ handleImportData }) => {\n  const [isFullGrid, setIsFullGrid] = useState(true);\n\n  const handleToggleGrid = () => {\n    setIsFullGrid(!isFullGrid);\n\n    if (isFullGrid) {\n      gantt.getGridColumn(\"wbs\").hide = true;\n      gantt.getGridColumn(\"start_date\").hide = true;\n      gantt.getGridColumn(\"amount\").hide = true;\n\n      gantt.config.grid_width = 150;\n    } else {\n      gantt.getGridColumn(\"wbs\").hide = false;\n      gantt.getGridColumn(\"start_date\").hide = false;\n      gantt.getGridColumn(\"amount\").hide = false;\n\n      gantt.config.grid_width = 190;\n    }\n    gantt.render();\n  };\n\n  const handleFullscreen = () => {\n    gantt.ext.fullscreen.expand();\n  };\n\n  const restoreData = () => {\n    localStorage.setItem(\"hiifx_data\", JSON.stringify(CONSTANT.INIT_DATA));\n    window.location.reload();\n  };\n\n  const exportAndDownload = () => {\n    const result = gantt.serialize();\n\n    fileDownloader(\n      JSON.stringify(result),\n      `${new Date()\n        .toISOString()\n        .substring(0, 10)\n        .split(\"-\")\n        .join(\"\")}_海匯團隊.json`\n    );\n  };\n\n  const handleExportModel = () => {\n    window.importBox = gantt.modalbox({\n      title: \"設定\",\n      text: `\n            <label for=\"data-import\" class=\"data-import-label\">\n              匯入紀錄\n            </label>\n            <input id=\"data-import\" type=\"file\" onchange=\"gantt.importFromJSON(this)\" accept=\"application/json\" />\n            `,\n      width: \"500px\",\n      buttons: [\n        {\n          label: \"匯出紀錄\",\n          css: \"data_export_btn\",\n          value: \"export\",\n        },\n        {\n          label: \"重設紀錄\",\n          css: \"data_export_restore\",\n          value: \"restore\",\n        },\n        { label: \"取消\", css: \"data_cancel_btn\", value: \"cancel\" },\n      ],\n      callback: function (action) {\n        if (action === \"restore\") {\n          restoreData();\n        }\n        if (action === \"export\") {\n          exportAndDownload();\n        }\n        if (action === \"cancel\") {\n          // gantt.alert(action);\n        }\n      },\n    });\n  };\n\n  useEffect(() => {\n    const importFromJSON = (event) => {\n      if (event.files.length > 0) {\n        const FILE_READER = new FileReader();\n\n        FILE_READER.addEventListener(\"load\", () => {\n          try {\n            const NEW_DATA = JSON.parse(FILE_READER.result);\n            const validatedNewData = utils.sterilizateData(NEW_DATA);\n\n            localStorage.setItem(\n              \"hiifx_data\",\n              JSON.stringify(validatedNewData)\n            );\n            gantt.message({\n              type: \"info\",\n              text: \"匯入成功~~🎉🎉\",\n            });\n\n            handleImportData();\n          } catch (err) {\n            gantt.message({\n              type: \"error\",\n              text: \"匯入資料格式錯誤 😱😱\",\n            });\n          }\n        });\n        FILE_READER.addEventListener(\"error\", () => {\n          gantt.message({\n            type: \"error\",\n            text: \"匯入資料時發生錯誤 😱😱\",\n          });\n        });\n\n        FILE_READER.readAsText(event.files[0]);\n      }\n    };\n\n    gantt.importFromJSON = importFromJSON;\n  }, [handleImportData]);\n\n  return (\n    <div className=\"tool-bar\">\n      <div className=\"logo-wrapper noselect\" onClick={handleToggleGrid}>\n        {isFullGrid ? <Menu /> : <ChevronRight />}\n        <b className=\"short-LOGO\">海匯</b>\n        <b className=\"full-LOGO\">海匯團隊資金管理工具</b>\n      </div>\n      <div className=\"tool-wrapper\">\n        <div className=\"action-icon-wrapper\">\n          <SkipBack onClick={() => gantt.undo()} />\n          <SkipForward onClick={() => gantt.redo()} />\n        </div>\n        <div className=\"zoom-icon-wrapper\">\n          <ZoomIn onClick={() => gantt.ext.zoom.zoomIn()} />\n          <ZoomOut onClick={() => gantt.ext.zoom.zoomOut()} />\n        </div>\n        <div className=\"fullscreen-icon-wrapper\" onClick={handleFullscreen}>\n          <Maximize />\n        </div>\n        <div className=\"export-icon-wrapper\" onClick={handleExportModel}>\n          <Settings />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Toolbar;\n","import Toolbar from './Toolbar';\nimport './Toolbar.css';\nexport default Toolbar;","import React from \"react\";\n\nconst MessageArea = ({ messages }) => {\n  const renderMessageArea = messages.map(({ message }) => {\n    return <li key={Math.random()}>{message}</li>;\n  });\n\n  return (\n    <div className=\"message-area\">\n      <h3>操作紀錄：</h3>\n      <ul>{renderMessageArea}</ul>\n    </div>\n  );\n};\n\nMessageArea.defaultProps = {\n  messages: [],\n};\n\nexport default MessageArea;\n","import MessageArea from './MessageArea';\nimport './MessageArea.css';\nexport default MessageArea;","import React, { Component } from \"react\";\nimport { gantt } from \"dhtmlx-gantt\";\nimport PWAPrompt from \"react-ios-pwa-prompt\";\n\nimport GanttChart from \"./components/Gantt\";\nimport Toolbar from \"./components/Toolbar\";\nimport MessageArea from \"./components/MessageArea\";\nimport * as CONSTANT from \"./utils/constant\";\nimport * as utils from \"./utils\";\nimport \"./App.css\";\n\nclass App extends Component {\n  state = {\n    isReady: false,\n    isUpdating: false,\n    tasks: null,\n    currentZoom: \"月\",\n    messages: [],\n  };\n\n  addMessage(message) {\n    const maxLogLength = 5;\n    const newMessate = { message };\n    const messages = [newMessate, ...this.state.messages];\n\n    if (messages.length > maxLogLength) {\n      messages.length = maxLogLength;\n    }\n    this.setState({ messages });\n  }\n\n  logDataUpdate = (type, action, item, id) => {\n    if (this.state.isUpdating === false) {\n      this.setState({ isUpdating: true });\n      let holder = item && item.holder ? ` (${item.holder})` : \"\";\n      let message = `${type} ${action}: ${id} ${holder}`;\n      if (type === \"link\" && action !== \"delete\") {\n        message += ` ( source: ${item.source}, target: ${item.target} )`;\n      }\n      this.addMessage(message);\n      const { data: currentData, links: currentLinks } = gantt.serialize();\n      const NEW_DATA = {\n        data: currentData.map((newItem) => ({\n          ...newItem,\n          // profit_date: newItem.profit_date ?? null,\n          directMember: gantt.getChildren(newItem.id).length ?? 0,\n          directMemberAmount: utils.getFirstLayerAmount(newItem.id) ?? 0,\n          teamMember: utils.getAllLayerAmount(newItem.id)[\"teamMember\"],\n          teamAmount: utils.getAllLayerAmount(newItem.id)[\"teamAmount\"],\n          level: utils.getSelfLevel(newItem.id),\n          // duration: 35,\n          progress: utils.getSelfProgress(newItem.start_date) ?? 0.6,\n          $open: true,\n        })),\n        links: currentLinks,\n      };\n\n      localStorage.setItem(\"hiifx_data\", JSON.stringify(NEW_DATA));\n      this.setState({ isUpdating: false });\n    }\n  };\n\n  updateImportData = () => {\n    this.setState({ isReady: false });\n    const LOCAL_DATA = localStorage.getItem(\"hiifx_data\");\n    this.setState({ tasks: JSON.parse(LOCAL_DATA), isReady: true });\n    gantt.modalbox.hide(window.importBox);\n  };\n\n  componentDidMount() {\n    const LOCAL_DATA = localStorage.getItem(\"hiifx_data\");\n    if (!!LOCAL_DATA) {\n      this.setState({ tasks: JSON.parse(LOCAL_DATA), isReady: true });\n    } else {\n      localStorage.setItem(\"hiifx_data\", JSON.stringify(CONSTANT.INIT_DATA));\n      this.setState({ tasks: CONSTANT.INIT_DATA, isReady: true });\n    }\n  }\n\n  render() {\n    const { isReady, tasks, currentZoom, messages } = this.state;\n\n    return (\n      <div>\n        <div className=\"tool-bar-container\">\n          <Toolbar handleImportData={this.updateImportData} />\n        </div>\n        <div id=\"rotate-hint\">\n          <div id=\"rotate-icon-wrapper\" />\n          <div id=\"rotate-hint-wrapper\">請翻轉手機</div>\n        </div>\n        <div className=\"gantt-container\">\n          {isReady && (\n            <GanttChart\n              tasks={tasks}\n              zoom={currentZoom}\n              onDataUpdated={this.logDataUpdate}\n            />\n          )}\n        </div>\n        <MessageArea messages={messages} />\n        <PWAPrompt />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/hiifx-sw.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://goo.gl/SC7cgQ\"\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log(\"New content is available; please refresh.\");\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get(\"content-type\").indexOf(\"javascript\") === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport registerServiceWorker from \"./registerServiceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\nregisterServiceWorker();\n"],"sourceRoot":""}