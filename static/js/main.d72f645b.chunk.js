(this.webpackJsonphiifx_management=this.webpackJsonphiifx_management||[]).push([[0],{11:function(t,e,n){t.exports=n(28)},16:function(t,e,n){},22:function(t,e,n){},25:function(t,e,n){},26:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),r=n(9),i=n.n(r),s=(n(16),n(10)),l=n(3),c=n(4),d=n(6),u=n(5),m=n(0),g=(n(8),n(17),n(18),n(19),n(20),n(21),function(t){var e=[],n=[];return function t(a){m.gantt.getChildren(a).forEach((function(a){var o=m.gantt.getTask(a);e.push(o.holder),n.push(o.amount),t(a)}))}(t),{teamMember:e.length,teamAmount:n.reduce((function(t,e){return t+Number(e)}),0)}}),h=function(t){var e=m.gantt.getChildren(t),n=0;return e.forEach((function(t){var e,a=m.gantt.getTask(t);n+=Number(null!==(e=a.amount)&&void 0!==e?e:0)})),n},f={type:"text",map_to:"holder"},p={type:"text",map_to:"amount"},_={type:"date",map_to:"start_date",min:new Date(2018,0,1),max:new Date},v=m.gantt.date.date_to_str(m.gantt.config.task_date),b={data:[{id:1,holder:"\u81ea\u5df1",start_date:"2020-01-01",amount:1500,duration:30,progress:.6,$open:!0},{id:2,holder:"\u6295\u8cc7\u4eba #1",start_date:"2020-01-01",parent:1,amount:1500,duration:30,progress:.4}],links:[{id:1,source:1,target:2,type:"0"}]},w={levels:[{name:"\u65e5",scale_height:27,min_column_width:80,scales:[{unit:"day",step:1,format:"%d %M"}]},{name:"\u9031",scale_height:50,min_column_width:50,scales:[{unit:"week",step:1,format:function(t){var e=m.gantt.date.date_to_str("%d %M"),n=m.gantt.date.add(t,-6,"day");return"#"+m.gantt.date.date_to_str("%W")(t)+", "+e(t)+" - "+e(n)}},{unit:"day",step:1,format:"%j %D"}]},{name:"\u6708",scale_height:50,min_column_width:120,scales:[{unit:"month",format:"%F, %Y"},{unit:"week",format:"Week #%W"}]},{name:"\u5b63",height:50,min_column_width:90,scales:[{unit:"month",step:1,format:"%M"},{unit:"quarter",step:1,format:function(t){var e=m.gantt.date.date_to_str("%M"),n=m.gantt.date.add(m.gantt.date.add(t,3,"month"),-1,"day");return e(t)+" - "+e(n)}}]},{name:"\u5e74",scale_height:50,min_column_width:30,scales:[{unit:"year",step:1,format:"%Y"}]}]},k=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).dataProcessor=null,a.initZoom(),a}return Object(c.a)(n,[{key:"initZoom",value:function(){m.gantt.ext.zoom.init(w)}},{key:"setZoom",value:function(t){m.gantt.ext.zoom.setLevel(t)}},{key:"initGanttDataProcessor",value:function(){var t=this.props.onDataUpdated;this.dataProcessor=m.gantt.createDataProcessor((function(e,n,a,o){return new Promise((function(r,i){return t&&t(e,n,a,o),r()}))}))}},{key:"shouldComponentUpdate",value:function(t){return this.props.zoom!==t.zoom}},{key:"componentDidMount",value:function(){m.gantt.addMarker({start_date:new Date,css:"today",text:"\u4eca\u5929",title:v(new Date)}),m.gantt.config.quickinfo_buttons=["icon_edit","icon_delete"],m.gantt.config.reorder_grid_columns=!0,m.gantt.config.order_branch=!0,m.gantt.config.keep_grid_width=!0,m.gantt.config.xml_date="%Y-%m-%d %H:%i",m.gantt.config.columns=[{name:"wbs",label:"\u7de8\u865f",align:"center",max_width:64,resize:!0,template:m.gantt.getWBSCode},{name:"holder",label:"\u6295\u8cc7\u4eba",min_width:150,max_width:200,tree:!0,resize:!0,editor:f},{name:"amount",label:"\u6295\u8cc7\u984d",align:"center",min_width:40,resize:!0,editor:p},{name:"start_date",label:"\u521d\u59cb\u8a17\u7ba1\u65e5",align:"center",max_width:96,resize:!0,editor:_},{name:"add",width:40}],m.gantt.config.lightbox.sections=[{name:"holder",height:30,map_to:"holder",type:"textarea"},{name:"amount",height:30,map_to:"amount",type:"textarea"},{name:"parent",type:"parent",allow_root:"true",root_label:"\u7121\u63a8\u85a6\u7d93\u7d00\u4eba",template:function(t,e,n){return 0===n.id?"\u7121\u63a8\u85a6\u7d93\u7d00\u4eba":n.holder}},{name:"time",map_to:"auto",type:"duration"}],m.gantt.locale.labels.section_holder="\u6295\u8cc7\u4eba",m.gantt.locale.labels.section_amount="\u6295\u8cc7\u984d",m.gantt.locale.labels.section_parent="\u63a8\u85a6\u7d93\u7d00\u4eba",m.gantt.locale.labels.section_time="\u8a17\u7ba1\u6642\u9593",m.gantt.locale.labels.icon_delete="\u522a\u9664\u7d00\u9304",m.gantt.locale.labels.icon_edit="\u7de8\u8f2f\u7d00\u9304",m.gantt.locale.labels.confirm_link_deleting="\u5c07\u88ab\u522a\u9664",m.gantt.locale.labels.icon_save="\u5132\u8cc7\u91d1\u7d00\u9304",m.gantt.locale.labels.icon_cancel="\u53d6\u6d88",m.gantt.attachEvent("onLightboxSave",(function(t,e){return e.holder?!!e.amount||(m.gantt.message({type:"error",text:"\u8acb\u8f38\u5165\u6295\u8cc7\u984d"}),!1):(m.gantt.message({type:"error",text:"\u8acb\u8f38\u5165\u6295\u8cc7\u4eba"}),!1)})),m.gantt.templates.task_class=function(t,e,n){return{0:"top-layer",1:"first-layer",2:"second-layer",3:"third-layer"}[(m.gantt.getWBSCode(n).match(/\./g)||[]).length]},m.gantt.templates.quick_info_title=function(t,e,n){return n.holder},m.gantt.templates.quick_info_content=function(t,e,n){return"\u968e\u7d1a\uff1a \u5c1a\u672a\u5b8c\u6210 </br>\n      \u81ea\u8eab\u7d81\u5b9a\uff1a ".concat(n.amount," </br>\n      \u6709\u6548\u76f4\u63a8\uff1a").concat(n.directMember," </br>\n      \u76f4\u63a8\u7d81\u5b9a\uff1a ").concat(n.directMemberAmount," </br>\n      \u5718\u968a\u4eba\u6578\uff1a ").concat(n.teamMember," </br>\n      \u5718\u968a\u7d81\u5b9a\uff1a ").concat(n.teamAmount," </br>\n      ")},m.gantt.templates.scale_cell_class=function(t){if(0===t.getDay()||6===t.getDay())return"weekend"},m.gantt.templates.timeline_cell_class=function(t,e){if(0===e.getDay()||6===e.getDay())return"weekend"},m.gantt.templates.task_text=function(t,e,n){return"<b>".concat(n.holder,"</b> > <b>").concat(n.amount,"</b> \u7f8e\u91d1")},m.gantt.templates.rightside_text=function(t,e,n){var a=((new Date).getTime()-new Date(t).getTime())/864e5;return a>0?"<b>\u8a17\u7ba1 </b>"+Math.floor(a)+"\u5929":"<b>\u5c1a\u672a\u958b\u59cb\u8a17\u7ba1</b>"},m.gantt.templates.progress_text=function(t,e,n){return"<span class='progress_text'>"+m.gantt.getChildren(n.id).length+" \u76f4\u63a8 </span>"},m.gantt.templates.link_class=function(t){var e;return null!==(e={1:"first-link",2:"second-link",3:"third-link"}[t.source])&&void 0!==e?e:""},m.gantt.templates.grid_folder=function(t){return"<div class='gantt_tree_icon gantt_folder_".concat(t.$open?"open":"closed"," ").concat(t.level,"'></div>")},m.gantt.templates.grid_file=function(t){return"<div class='gantt_tree_icon gantt_file ".concat(t.level,"'></div>")};var t=this.props.tasks;m.gantt.init(this.ganttContainer),this.initGanttDataProcessor(),m.gantt.parse(t)}},{key:"componentWillUnmount",value:function(){this.dataProcessor&&(this.dataProcessor.destructor(),this.dataProcessor=null)}},{key:"render",value:function(){var t=this,e=this.props.zoom;return this.setZoom(e),o.a.createElement("div",{ref:function(e){t.ganttContainer=e},style:{width:"100%",height:"100%"}})}}]),n}(a.Component),y=(n(22),k),x=n(30),E=n(31),M=n(32),D=n(33),C=n(34),S=function(){return o.a.createElement("div",{className:"tool-bar"},o.a.createElement("div",null,o.a.createElement("b",null,"\u6d77\u532f\u5718\u968a\u8cc7\u91d1\u7ba1\u7406\u5de5\u5177")),o.a.createElement("div",{className:"tool-wrapper"},o.a.createElement("div",{className:"action-icon-wrapper"},o.a.createElement(x.a,{onClick:function(){return m.gantt.undo()}}),o.a.createElement(E.a,{onClick:function(){return m.gantt.redo()}})),o.a.createElement("div",{className:"zoom-icon-wrapper"},o.a.createElement(M.a,{onClick:function(){return m.gantt.ext.zoom.zoomIn()}}),o.a.createElement(D.a,{onClick:function(){return m.gantt.ext.zoom.zoomOut()}})),o.a.createElement("div",{className:"fullscreen-icon-wrapper",onClick:function(){m.gantt.ext.fullscreen.expand(),m.gantt.getGridColumn("wbs").hide=!0,m.gantt.getGridColumn("duration").hide=!0,m.gantt.getGridColumn("start_date").hide=!0,m.gantt.config.grid_width=150,m.gantt.render()}},o.a.createElement(C.a,null))))},z=(n(25),S),N=function(t){var e=t.messages.map((function(t){var e=t.message;return o.a.createElement("li",{key:Math.random()},e)}));return o.a.createElement("div",{className:"message-area"},o.a.createElement("h3",null,"\u64cd\u4f5c\u7d00\u9304\uff1a"),o.a.createElement("ul",null,e))};N.defaultProps={messages:[]};var O=N,j=(n(26),O);n(27);Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t};var U=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(l.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))).state={isReady:!1,isUpdating:!1,tasks:null,currentZoom:"\u6708",messages:[]},t.logDataUpdate=function(e,n,a,o){if(!1===t.state.isUpdating){t.setState({isUpdating:!0});var r=a&&a.holder?" (".concat(a.holder,")"):"",i="".concat(e," ").concat(n,": ").concat(o," ").concat(r);"link"===e&&"delete"!==n&&(i+=" ( source: ".concat(a.source,", target: ").concat(a.target," )")),t.addMessage(i);var s={data:m.gantt.getTaskByTime().map((function(t){var e,n,a,o,r,i;return{id:t.id,holder:t.holder,amount:null!==(e=t.amount)&&void 0!==e?e:0,directMember:null!==(n=m.gantt.getChildren(t.id).length)&&void 0!==n?n:0,directMemberAmount:null!==(a=h(t.id))&&void 0!==a?a:0,teamMember:g(t.id).teamMember,teamAmount:g(t.id).teamAmount,level:(t.id,"trader"),start_date:new Date(t.start_date).Format("yyyy-MM-dd"),duration:null!==(o=t.duration)&&void 0!==o?o:35,progress:null!==(r=t.progress)&&void 0!==r?r:.6,parent:null!==(i=t.parent)&&void 0!==i?i:void 0,$open:!0}})),links:m.gantt.getLinks()};localStorage.setItem("hiifx_data",JSON.stringify(s)),t.setState({isUpdating:!1})}},t}return Object(c.a)(n,[{key:"addMessage",value:function(t){var e=[{message:t}].concat(Object(s.a)(this.state.messages));e.length>5&&(e.length=5),this.setState({messages:e})}},{key:"componentDidMount",value:function(){var t=localStorage.getItem("hiifx_data");t?this.setState({tasks:JSON.parse(t),isReady:!0}):(localStorage.setItem("hiifx_data",JSON.stringify(b)),this.setState({tasks:b,isReady:!0}))}},{key:"render",value:function(){var t=this.state,e=t.isReady,n=t.tasks,a=t.currentZoom,r=t.messages;return o.a.createElement("div",null,o.a.createElement("div",{className:"tool-bar-container"},o.a.createElement(z,null)),o.a.createElement("div",{className:"gantt-container"},e&&o.a.createElement(y,{tasks:n,zoom:a,onDataUpdated:this.logDataUpdate})),o.a.createElement(j,{messages:r}))}}]),n}(a.Component),W=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function P(t){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var e=t.installing;e.onstatechange=function(){"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(t){console.error("Error during service worker registration:",t)}))}i.a.render(o.a.createElement(U,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/hiifx_management",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/hiifx_management","/sw.js");W?(!function(t){fetch(t).then((function(e){404===e.status||-1===e.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):P(t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):P(t)}))}}()}},[[11,1,2]]]);
//# sourceMappingURL=main.d72f645b.chunk.js.map